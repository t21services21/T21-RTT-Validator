# üîê COMPLETE ACCESS CONTROL SYSTEM - USER GUIDE

## ‚úÖ **WHAT YOU NOW HAVE:**

### **COMPLETE ROLE-BASED ACCESS CONTROL**

You can now manage:
- ‚úÖ Students (4 tiers)
- ‚úÖ T21 Staff (2 types)
- ‚úÖ Administrators (2 levels)
- ‚úÖ Custom permissions
- ‚úÖ Suspend/Resume accounts
- ‚úÖ Terminate accounts (permanent)
- ‚úÖ Grant/Revoke permissions
- ‚úÖ Extend licenses
- ‚úÖ Change roles
- ‚úÖ Complete audit trail

---

## üë• **USER TYPES & ROLES:**

### **STUDENTS (4 Tiers):**

1. **Trial Student** (`student_trial`)
   - Duration: 7 days FREE
   - Features: Limited access (5 scenarios, 10 quizzes/day, 5 AI Q/day)

2. **Basic Student** (`student_basic`)
   - Duration: 3 months
   - Price: ¬£599
   - Features: All training, limited AI (10 Q/day)

3. **Professional Student** (`student_professional`)
   - Duration: 6 months
   - Price: ¬£999
   - Features: Unlimited AI, PAS practice, reports

4. **Ultimate Student** (`student_ultimate`)
   - Duration: 1 year
   - Price: ¬£1,499
   - Features: Everything + Certification + Priority support

### **T21 STAFF (2 Types):**

5. **Trainer** (`staff_trainer`)
   - Duration: 1 year
   - Access: All tools + student management (view) + create content + grade exams
   - Can: View students, create scenarios, grade exams

6. **Support Staff** (`staff_support`)
   - Duration: 1 year
   - Access: Basic tools + student management (view) + support tickets
   - Can: View students, handle support requests

### **ADMINISTRATORS (2 Levels):**

7. **Administrator** (`admin`)
   - Duration: Unlimited
   - Access: FULL access to all features + user management
   - Can: Manage students, manage staff, view reports, manage licenses

8. **Super Administrator** (`super_admin`)
   - Duration: Unlimited
   - Access: EVERYTHING + can manage other admins
   - Can: Everything + terminate accounts + manage admins + database access

---

## üéØ **WHAT EACH ROLE CAN DO:**

### **STUDENTS:**
- ‚úÖ Access learning materials (based on tier)
- ‚úÖ Take quizzes and exams (based on tier)
- ‚úÖ Use AI Tutor (limited or unlimited)
- ‚úÖ Build CV
- ‚úÖ Practice interviews
- ‚ùå Cannot manage other users
- ‚ùå Cannot access admin panel

### **T21 STAFF:**
- ‚úÖ All student features (unlimited)
- ‚úÖ View student list
- ‚úÖ Create training content (trainers only)
- ‚úÖ Grade exams (trainers only)
- ‚úÖ Handle support tickets (support staff)
- ‚ö†Ô∏è Limited admin panel (view only)
- ‚ùå Cannot suspend/terminate users

### **ADMINISTRATORS:**
- ‚úÖ FULL access to all features
- ‚úÖ Manage all students
- ‚úÖ Manage all staff
- ‚úÖ Suspend/unsuspend users
- ‚úÖ Extend licenses
- ‚úÖ Change roles
- ‚úÖ Grant/revoke permissions
- ‚úÖ View revenue reports
- ‚úÖ View audit logs
- ‚ö†Ô∏è Cannot terminate accounts (super admin only)
- ‚ö†Ô∏è Cannot manage other admins

### **SUPER ADMINISTRATORS:**
- ‚úÖ EVERYTHING administrators can do
- ‚úÖ TERMINATE accounts (permanent)
- ‚úÖ Manage other administrators
- ‚úÖ Delete users from database
- ‚úÖ Full database access
- ‚úÖ System settings

---

## üõ†Ô∏è **ADMIN ACTIONS YOU CAN DO:**

### **1. CREATE USER**
```
Who can do this: Admin, Super Admin
What it does: Create new student, staff, or admin account
```

### **2. SUSPEND USER**
```
Who can do this: Admin, Super Admin
What it does: Temporarily block access (can be reversed)
Why: Violation of terms, payment issue, investigation
```

### **3. UNSUSPEND USER**
```
Who can do this: Admin, Super Admin
What it does: Restore access to suspended account
```

### **4. TERMINATE USER** ‚ö†Ô∏è
```
Who can do this: Super Admin ONLY
What it does: PERMANENTLY disable account (CANNOT be undone!)
Why: Serious violation, fraud, legal reasons
```

### **5. DELETE USER** üóëÔ∏è
```
Who can do this: Super Admin ONLY
What it does: Completely remove user from database
Why: GDPR request, cleanup, data management
```

### **6. EXTEND LICENSE**
```
Who can do this: Admin, Super Admin
What it does: Add days to user's license
Example: Extend by 30 days as compensation
```

### **7. CHANGE ROLE**
```
Who can do this: Admin, Super Admin
What it does: Upgrade/downgrade user's role
Example: Trial ‚Üí Professional, Basic ‚Üí Ultimate
```

### **8. GRANT CUSTOM PERMISSION**
```
Who can do this: Admin, Super Admin
What it does: Give specific feature access
Example: Give certification exam to Basic student
```

### **9. REVOKE CUSTOM PERMISSION**
```
Who can do this: Admin, Super Admin
What it does: Remove specific feature access
Example: Remove AI Tutor from a student
```

---

## üìä **ADMIN PANEL FEATURES:**

### **DASHBOARD TAB:**
- Total users count
- Active/suspended/expired/terminated breakdown
- Revenue statistics
- Recent activity log
- Charts and graphs

### **USER MANAGEMENT TAB:**
- View all users (filterable by type/status)
- User details (profile, usage stats, notes)
- Quick actions:
  - Suspend/Unsuspend
  - Terminate
  - Change Role
  - Extend License
  - Delete
- Create new user form

### **PERMISSIONS TAB:**
- View user's custom permissions
- Grant specific permissions
- Revoke specific permissions
- Override role defaults

### **REVENUE & ANALYTICS TAB:**
- Total revenue
- Revenue by plan
- Active paying students
- Breakdown charts

### **AUDIT LOG TAB:**
- Complete history of all admin actions
- Who did what, when, to whom
- Filterable and searchable
- Export capability

### **SYSTEM SETTINGS TAB:**
- View all role definitions
- Platform configuration
- System-wide settings

---

## üöÄ **HOW TO USE IT:**

### **STEP 1: CREATE YOUR SUPER ADMIN ACCOUNT**

Run this Python script **ONCE** to create your account:

```python
from admin_management import create_user

# Create your super admin account
# (First user must be created manually)

import json
from advanced_access_control import UserAccount
import hashlib

# Create super admin
super_admin = UserAccount(
    user_id="admin001",
    email="your-email@t21services.co.uk",  # CHANGE THIS
    role="super_admin",
    full_name="Your Name",  # CHANGE THIS
    created_by="system"
)

# Save to database
users = {
    "your-email@t21services.co.uk": super_admin.to_dict()
}

# Add password
users["your-email@t21services.co.uk"]["password_hash"] = hashlib.sha256("YourPassword123".encode()).hexdigest()

# Save
with open("users_advanced.json", "w") as f:
    json.dump(users, f, indent=2)

print("Super Admin created!")
print("Email: your-email@t21services.co.uk")
print("Password: YourPassword123")
```

### **STEP 2: INTEGRATE INTO APP.PY**

Add this to your `app.py`:

```python
# At the top, import admin panel
from admin_panel_ui import render_admin_panel
from advanced_access_control import UserAccount

# In your sidebar menu, add:
"üîß Admin Panel",  # NEW!

# At the end of your tool checks, add:
elif tool == "üîß Admin Panel":
    # Check if user is admin
    if st.session_state.user_license:
        user_type = st.session_state.user_license.role
        if "admin" in user_type:
            render_admin_panel(st.session_state.user_email)
        else:
            st.error("‚õî Access Denied - Admin privileges required")
```

### **STEP 3: START APP & LOGIN**

```powershell
py -3.12 -m streamlit run app.py
```

Login with your super admin credentials.

### **STEP 4: CREATE OTHER USERS**

1. Go to "üîß Admin Panel"
2. Click "User Management" tab
3. Scroll to "Create New User"
4. Fill in:
   - Email
   - Password
   - Name
   - Role (choose from dropdown)
5. Click "Create User"

### **STEP 5: MANAGE USERS**

- **View all users**: See filterable list
- **Select user**: Choose from dropdown
- **See details**: Profile, usage, permissions
- **Take action**: Suspend, extend, change role, etc.

---

## üí° **COMMON WORKFLOWS:**

### **WORKFLOW 1: STUDENT REGISTERS**
1. Student signs up (gets trial automatically)
2. Trial lasts 7 days
3. Trial expires ‚Üí Student contacts you
4. You upgrade them to paid plan

### **WORKFLOW 2: UPGRADE STUDENT**
1. Student pays you (bank transfer/PayPal)
2. You login as admin
3. Go to Admin Panel ‚Üí User Management
4. Select student
5. Click "Change Role"
6. Select new role (e.g., Professional)
7. Confirm

### **WORKFLOW 3: SUSPEND PROBLEMATIC USER**
1. You detect violation (e.g., sharing account)
2. Login as admin
3. Go to Admin Panel ‚Üí User Management
4. Select user
5. Click "Suspend"
6. Enter reason: "Account sharing violation"
7. Confirm
8. User immediately loses access

### **WORKFLOW 4: EXTEND LICENSE (COMPENSATION)**
1. Student had technical issue
2. You offer 1 week free extension
3. Go to Admin Panel ‚Üí User Management
4. Select student
5. Click "Extend License"
6. Enter 7 days
7. Confirm
8. Student's expiry date extended

### **WORKFLOW 5: GRANT SPECIAL PERMISSION**
1. Basic student needs certification exam (special case)
2. Go to Admin Panel ‚Üí Permissions
3. Select student
4. Feature name: "certification_exam"
5. Click "Grant"
6. Student can now access certification (even though Basic plan normally can't)

### **WORKFLOW 6: HIRE NEW TRAINER**
1. You hire someone to teach RTT
2. Go to Admin Panel ‚Üí User Management
3. Click "Create New User"
4. Email: trainer@t21services.co.uk
5. Role: staff_trainer
6. They can now:
   - Access all tools
   - View students
   - Create scenarios
   - Grade exams

### **WORKFLOW 7: TERMINATE FRAUDULENT ACCOUNT**
1. You discover fraud
2. Login as SUPER ADMIN (only super admin can terminate)
3. Go to Admin Panel ‚Üí User Management
4. Select user
5. Click "Terminate"
6. Enter reason: "Fraudulent payment"
7. Confirm with checkbox
8. Account PERMANENTLY disabled

---

## üìã **AUDIT TRAIL:**

Every action is logged:
- Who did it
- What they did
- When they did it
- To whom
- Why (if reason provided)

**Example log entries:**
```
2025-10-08 10:30:15 - CREATE_USER - admin@t21.co.uk ‚Üí student@email.com - Role: student_professional
2025-10-08 11:45:22 - SUSPEND_USER - admin@t21.co.uk ‚Üí baduser@email.com - Reason: Account sharing
2025-10-08 14:20:33 - EXTEND_LICENSE - admin@t21.co.uk ‚Üí student@email.com - Extended by 30 days
2025-10-08 16:55:44 - GRANT_PERMISSION - admin@t21.co.uk ‚Üí student@email.com - Feature: certification_exam
```

---

## üîí **SECURITY FEATURES:**

‚úÖ **Password Hashing** - SHA-256
‚úÖ **Permission Checks** - Every action verified
‚úÖ **Audit Logging** - Complete trail
‚úÖ **Role-Based Access** - Granular control
‚úÖ **Status Management** - Active/Suspended/Terminated
‚úÖ **Cannot Self-Action** - Can't suspend yourself
‚úÖ **Super Admin Protection** - Only super admin can terminate

---

## üìä **REVENUE TRACKING:**

The system automatically tracks:
- Total revenue from all active students
- Revenue breakdown by plan
- Number of paying students
- Average revenue per student

**Example:**
```
Total Revenue: ¬£49,950
Active Students: 50

Breakdown:
- Trial: 10 students (¬£0)
- Basic: 20 students (¬£11,980)
- Professional: 15 students (¬£14,985)
- Ultimate: 5 students (¬£7,495)
```

---

## ‚öôÔ∏è **FILES CREATED:**

1. **`advanced_access_control.py`** (500+ lines)
   - All user types and roles
   - Permission system
   - Account management

2. **`admin_management.py`** (600+ lines)
   - Admin functions
   - User management
   - Analytics & reporting
   - Audit logging

3. **`admin_panel_ui.py`** (600+ lines)
   - Streamlit UI for admin panel
   - 6 tabs (Dashboard, Users, Permissions, Revenue, Audit, Settings)

4. **`users_advanced.json`** (Auto-created)
   - User database

5. **`audit_log.json`** (Auto-created)
   - Audit trail

---

## üéØ **SUMMARY:**

**YOU CAN NOW:**
‚úÖ Create users (students, staff, admins)
‚úÖ Suspend/unsuspend accounts
‚úÖ Terminate accounts (permanent)
‚úÖ Delete users (GDPR)
‚úÖ Extend licenses
‚úÖ Change roles (upgrade/downgrade)
‚úÖ Grant custom permissions
‚úÖ Revoke permissions
‚úÖ View all users
‚úÖ Filter by type/status
‚úÖ See usage statistics
‚úÖ Track revenue
‚úÖ View complete audit log
‚úÖ Manage everything from web UI

**YOUR STAFF CAN:**
‚úÖ Access all tools
‚úÖ View students (read-only)
‚úÖ Create content (trainers)
‚úÖ Grade exams (trainers)
‚úÖ Handle support tickets

**STUDENTS GET:**
‚úÖ Access based on their plan
‚úÖ Usage limits (if applicable)
‚úÖ Time-based expiry
‚úÖ Upgrade paths
‚úÖ Feature restrictions

---

## üöÄ **NEXT STEPS:**

1. ‚úÖ Create your super admin account
2. ‚úÖ Integrate admin panel into app
3. ‚úÖ Test creating users
4. ‚úÖ Test all admin functions
5. ‚úÖ Launch platform

---

**YOU NOW HAVE ENTERPRISE-LEVEL ACCESS CONTROL!** üéâ
